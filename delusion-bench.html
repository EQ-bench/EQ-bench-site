<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>DelusionBench Leaderboard</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.19/css/dataTables.bootstrap4.min.css">
  <link rel="stylesheet" type="text/css" href="style.css">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">
  <style>
    /* ===== Page shell (mirrors EQ-Bench 3) ===== */
    body.delusionbench-page { position: relative; min-height: 100%; }
    body.delusionbench-page::before{
      content:""; position:fixed; inset:0;
      background-image:url('./images/delusionbench_bg.png');
      background-position:center; background-size:cover;
      filter: blur(3px); opacity:.7; z-index:-2; pointer-events:none;
    }
    body.delusionbench-page::after{
      content:""; position:fixed; inset:0;
      background: radial-gradient(ellipse at center, rgba(255,255,255,0) 45%, rgba(255,255,255,0.9) 90%);
      z-index:-1; pointer-events:none;
    }
    body.delusionbench-page .container{
      background-color: rgba(255,255,255,.78) !important;
      border-radius:8px; padding:1rem 1rem;
    }
    body.dark-mode.delusionbench-page::before { opacity:.65; filter: blur(3px); }
    body.dark-mode.delusionbench-page::after{
      background: radial-gradient(ellipse at center, rgba(35,40,45,0) 45%, rgba(35,40,45,.9) 90%);
    }
    body.dark-mode.delusionbench-page .container{ background-color: rgba(35,40,45,.78)!important; }

    /* Header */
    .header{display:flex; align-items:center; gap:.75rem;}
    .header .logo{
        max-height: 100px;  /* or whatever fits nicely */
        height: auto;
        width: auto;
        }
    .nav-separator{opacity:.5; margin:0 .35rem;}

    /* Table chrome */
    #leaderboard-delusion { margin-top:0!important; }
    body.delusionbench-page #leaderboard-delusion thead th{
      background: rgba(60,70,80,.85)!important; color:#fff!important;
      font-size:.85em; text-align:center; vertical-align:middle;
    }
    body.dark-mode.delusionbench-page #leaderboard-delusion thead th{
      background: rgba(55,65,75,.85)!important;
    }
    /* Body cells & zebra striping */
    body.delusionbench-page #leaderboard-delusion tbody td { padding:0; white-space:normal; vertical-align:middle; }
    body.delusionbench-page #leaderboard-delusion.table-striped tbody tr:nth-of-type(odd) td:not(.feature-cell){
      background-color: rgba(245,245,245,.7)!important;
    }
    body.dark-mode.delusionbench-page #leaderboard-delusion.table-striped tbody tr:nth-of-type(odd) td:not(.feature-cell){
      background-color: rgba(45,50,55,.7)!important;
    }

    /* Cell content wrapper (uniform row height) */
    #leaderboard-delusion tbody td .cell-content{
      display:flex; align-items:center; justify-content:center;
      min-height:3em; line-height:1.3em; padding:.2em .4em; box-sizing:border-box;
    }
    #leaderboard-delusion tbody td:first-child .cell-content{
      justify-content:flex-start; gap:.3rem; white-space:normal!important; flex:1 1 auto;
    }
    #leaderboard-delusion tbody td.score-col .cell-content{ justify-content:flex-start; }

    /* Feature columns */
    #leaderboard-delusion td.feature-cell,
    #leaderboard-delusion th.feature-header{
      width:60px; min-width:40px;
      border-left:0!important; border-right:0!important;
    }
    #leaderboard-delusion td.feature-cell .cell-content{
      padding:2px 3px; font-size:.70rem; line-height:1.15; text-align:center; white-space:nowrap; color:#212529;
    }
    body.dark-mode.delusionbench-page #leaderboard-delusion td.feature-cell .cell-content{
      color:#fff; text-shadow: -1px -1px 0 rgba(0,0,0,.5), 1px -1px 0 rgba(0,0,0,.5), -1px 1px 0 rgba(0,0,0,.5), 1px 1px 0 rgba(0,0,0,.5);
    }

    /* Score bar + error bar (same mechanics) */
    .score-bar-container{ display:flex; align-items:center; gap:.5em; flex:1 1 auto; position:relative; min-height:1.5em; }
    .delusion-score-bar{ height:10px; border-radius:2px; background:#999; flex:0 0 auto; }
    .error-bar{ position:absolute; top:50%; height:2px; transform:translateY(-50%); border-radius:1px; pointer-events:none; display:none; z-index:2; background-color: rgba(0,0,0,.4);}
    body.dark-mode .error-bar{ background-color: rgba(255,255,255,.4); }
    .score-text{ position:relative; z-index:3; }
    body.delusionbench-page .score-text{ text-shadow:0 0 3px rgba(255,255,255,.7); }
    body.dark-mode.delusionbench-page .score-text{ text-shadow:0 0 4px rgba(0,0,0,.8); }

    /* Feature score container - no visible text, just bars */
    .feature-score-container{ 
      justify-content:flex-start; 
      cursor: pointer;
      width: 100%;
    }
    
    /* Feature score bars - less rounded */
    .feature-score-bar {
      border-radius: 2px;
    }

    /* Safety score container - text in front of bar with fixed width for alignment */
    .safety-score-container{ 
      justify-content:flex-start; 
      gap: 0.25em;
      width: 100%;
    }
    .safety-score-text{ 
      font-size: 0.9em; 
      text-shadow: 1px 1px 2px rgba(0,0,0,.6), -1px -1px 2px rgba(0,0,0,.6), 
                  1px -1px 2px rgba(0,0,0,.6), -1px 1px 2px rgba(0,0,0,.6);
      width: 2.6em;
      flex-shrink: 0;
      text-align: left;
    }

    body.dark-mode .safety-score-text{ 
      text-shadow: 1px 1px 2px rgba(255,255,255,.8), -1px -1px 2px rgba(255,255,255,.8), 
                   1px -1px 2px rgba(255,255,255,.8), -1px 1px 2px rgba(255,255,255,.8);
    }

    

    /* Column width preferences: grow criteria columns together; keep Sample narrow; don't let Model hog space */
    #leaderboard-delusion th.feature-header,
    #leaderboard-delusion td.feature-cell {
      /* equal widths for all criteria columns, with room to grow on wider screens */
      width: clamp(64px, 8vw, 160px);
    }

    #leaderboard-delusion th.sample-col,
    #leaderboard-delusion td.sample-col {
      /* force this column to stay tiny and not expand */
      width: 1%;
      white-space: nowrap;
    }

    #leaderboard-delusion th.model-col,
    #leaderboard-delusion td.model-col {
      /* allow wrap, but prefer width to flow to criteria first */
      width: auto;
    }

    /* Feature header truncation */

    #leaderboard-delusion thead th.feature-header,
    #leaderboard-delusion tfoot th.feature-header{
      white-space:nowrap; overflow:hidden; text-overflow:'-'; max-width:22px; text-align:center;
      text-decoration: underline !important; color:#fff!important;
      position: relative; padding: 2px 1px !important;
    }

    /* DataTables sorting styling - move arrows to top and allow text to use full width */
    #leaderboard-delusion thead th.sorting,
    #leaderboard-delusion thead th.sorting_asc, 
    #leaderboard-delusion thead th.sorting_desc {
      position: relative;
      padding-right: 2px !important;
    }
    
    #leaderboard-delusion thead th.sorting:after,
    #leaderboard-delusion thead th.sorting_asc:after,
    #leaderboard-delusion thead th.sorting_desc:after {
      position: absolute !important;
      top: 2px !important;
      right: 2px !important;
      font-size: 10px !important;
      line-height: 1 !important;
    }

    /* Override DataTables default padding to maximize text space */
    #leaderboard-delusion thead th {
      padding: 2px 1px !important;
    }

    /* Footer clone (sticky) */
    #leaderboard-delusion tfoot th{ background-color: rgba(60,70,80,.85); color:#fff!important; font-size:.85em; }

    body.dark-mode #leaderboard-delusion tfoot th{ background-color: rgba(55,65,75,.85); }

    /* Inline sticky header on row select */
    body.delusionbench-page #leaderboard-delusion tbody tr.selected-row{ position:relative; }
    body.delusionbench-page #leaderboard-delusion tbody tr.selected-row::after{
      content:""; position:absolute; inset:0; border:2px solid rgba(150,150,150,.5); pointer-events:none;
    }
    body.dark-mode.delusionbench-page #leaderboard-delusion tbody tr.selected-row::after{
      border-color: rgba(255,255,255,.2);
    }
    body.delusionbench-page #leaderboard-delusion tbody tr.floating-header-row th{
      position:sticky; top:0; z-index:3; background-color: rgba(60,70,80,.9)!important; color:#fff!important;
      font-size:.9em; white-space:nowrap; overflow:hidden; text-overflow:'-';
    }
    body.dark-mode.delusionbench-page #leaderboard-delusion tbody tr.floating-header-row th{ background-color: rgba(55,65,75,.9)!important; }
    #leaderboard-delusion tbody tr.stripe-buffer-row, #leaderboard-delusion tbody tr.stripe-buffer-row td{
      height:0!important; padding:0!important; border:none!important; visibility:hidden;
    }

    /* Heatmap legend */
    .heatmap-legend{ display:inline-flex; align-items:center; gap:.4rem; font-size:.85rem; user-select:none; }
    .heatmap-legend .legend-bar{ width:250px; height:10px; border-radius:4px; border:1px solid rgba(0,0,0,.15); }
    body.dark-mode .heatmap-legend .legend-bar{ border-color: rgba(255,255,255,.25); }

    /* Mobile collapse control */
    #toggleMiddleStats{ font-weight:bold; font-size:1rem; padding:.4rem 1rem; background-color:rgba(255,255,255,.9);
      border-color:#666; color:#333; box-shadow:0 1px 3px rgba(0,0,0,.2); margin-bottom:0!important; border-bottom-left-radius:0; border-bottom-right-radius:0; }
    body.dark-mode #toggleMiddleStats{ background-color: rgba(35,40,45,.9); color:#eee; border-color:#888; }
    @media (min-width:768px){ .hide-details-toggle-button{display:none!important;} }
    @media (max-width:767px){ .show-details-toggle-button{display:block!important;} }

    /* Container sizing */
    @media (min-width:768px){ .container{ width:95%!important; max-width:1400px; margin:0 auto; } }

    /* Track for safety score bars so % widths ignore the left score text */
    .score-track {
      position: relative;
      flex: 1 1 auto;
      height: 10px;
      display: flex;
      align-items: center;
    }

    /* Place safety bar and error bar inside the track */
    .safety-score-container .delusion-score-bar,
    .safety-score-container .error-bar {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      left: 0;
      right: auto;
    }

    /* Prevent any unexpected flex growth on bars; width is controlled via inline % */
    .delusion-score-bar { flex: 0 0 auto; }

    /* (Optional) keep feature bars block-level so % fills the track nicely */
    .feature-score-bar { display: block; }
    
    @media (min-width: 1050px) {
      #leaderboard-delusion th.model-col,
      #leaderboard-delusion td.model-col {
        min-width: 120px;
      }
    }
  </style>
</head>
<body class="delusionbench-page">
  <div class="container mt-4">
    <div class="form-check form-switch">
      <input class="form-check-input" type="checkbox" id="darkModeToggle">
      <label class="form-check-label" for="darkModeToggle" id="toggleLabel">Light</label>
    </div>

    <div class="header">
      <a href="./"><img src="./images/eqbench_logo_sml.png" alt="EQ-bench Logo" class="logo"/></a>
      <div class="header-text"><h1>DelusionEval</h1></div>
    </div>

    <p>Evaluating sycophancy and delusion-reinforcing behaviour in LLMs.</p>
    <p>
      <a href="./">Home</a>
      <span class="nav-separator">|</span>
      <a href='index.html'>💙EQ-Bench 3</a>
      <span class="nav-separator">|</span>
      <a href='creative_writing_longform.html'>✍️Longform Writing</a>
      <span class="nav-separator">|</span>
      <a href='judgemark-v2.html'>⚖️Judgemark v2.1</a>
    </p>

    <p class="mb-1"><b>Note:</b> Behaviour scores represent the number of times the behaviour occurred in a chatlog on average. It is not always "higher is better".</p>

    <button id="toggleMiddleStats" class="btn btn-outline-secondary btn-sm show-details-toggle-button d-none mb-2">
      Expand Details
    </button>

    <!-- Heat-map legend -->
    <div id="heatmapLegend" class="heatmap-legend">
      <span class="legend-label">Low</span>
      <div class="legend-bar"></div>
      <span class="legend-label">High</span>
    </div>

    <div class="table-responsive">
      <table id="leaderboard-delusion" class="table table-striped table-bordered">
        <thead>
          <tr id="db-head-row">
            <!-- Built dynamically from CSV header by JS -->
          </tr>
        </thead>
        <tfoot>
          <tr id="db-foot-row">
            <!-- Cloned from header by JS -->
          </tr>
        </tfoot>
        <tbody id="leaderboardDelusionBody"></tbody>
      </table>
    </div>

    <hr>
    <p>For details about the evaluation and metric definitions, see <a href="./about.html#delusionbench">About</a>.</p>
  </div>

  <!-- Vendor JS -->
  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
  <script src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script>
  <script src="https://cdn.datatables.net/1.10.19/js/dataTables.bootstrap4.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>


  <script defer src="delusion-bench.js?v=1.0.0"></script>

  <script defer src='https://static.cloudflareinsights.com/beacon.min.js' data-cf-beacon='{"token":"1600fe1d3da743c1b311f4e5fee86767"}'></script>
</body>
</html>