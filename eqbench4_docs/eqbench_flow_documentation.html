<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>EQ-Bench 4: How It Works</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,400;0,600;0,700;1,400&family=Merriweather:wght@400;700&display=swap');

        :root {
            --font-body: 'Lora', Georgia, serif;
            --font-heading: 'Merriweather', Georgia, serif;
            --bg-color: #fdfaf6;
            --text-color: #3a3a3a;
            --header-color: #5c4033;
            --subheader-color: #7a6a60;
            --border-color: #e0dcd1;
            --accent-border-color: #d3c0a5;
            --container-bg: #fffcf7;
            --card-bg: #f9f6f0;
            --hover-bg: #f5f0e8;
            --shadow-color: rgba(0, 0, 0, 0.08);
            --positive-color: #4a9c6d;
            --negative-color: #c75050;
            --neutral-color: #6a8caf;
            --chart-bg: #f0ebe3;
            --accent-1: #7c5295;
            --accent-2: #c9a227;
            --accent-3: #5a8c8c;
            --accent-4: #c75050;
        }

        body.dark-mode {
            --bg-color: #2a2527;
            --text-color: #fff9f2;
            --header-color: #f7eee0;
            --subheader-color: #e9dfd0;
            --border-color: #3e3936;
            --accent-border-color: #6a5349;
            --container-bg: #312c2e;
            --card-bg: #3a3335;
            --hover-bg: #413935;
            --shadow-color: rgba(0, 0, 0, 0.3);
            --chart-bg: #3a3638;
        }

        * { box-sizing: border-box; }

        body {
            font-family: var(--font-body);
            line-height: 1.7;
            color: var(--text-color);
            background-color: var(--bg-color);
            margin: 0;
            padding: 0;
            transition: background-color 0.3s, color 0.3s;
        }

        .main-container {
            max-width: 1100px;
            margin: 0 auto;
            padding: 30px;
        }

        h1, h2, h3, h4 {
            font-family: var(--font-heading);
            color: var(--header-color);
            margin-top: 1.5em;
            margin-bottom: 0.8em;
            line-height: 1.3;
        }

        h1 {
            text-align: center;
            font-size: 2.6em;
            margin-top: 0.5em;
            margin-bottom: 0.3em;
        }

        h2 {
            font-size: 1.8em;
            border-bottom: 2px solid var(--border-color);
            padding-bottom: 10px;
            margin-top: 2em;
        }

        h3 {
            font-size: 1.3em;
            color: var(--subheader-color);
        }

        .subtitle {
            text-align: center;
            color: var(--subheader-color);
            font-size: 1.2em;
            margin-bottom: 2em;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
        }

        p {
            margin-bottom: 1em;
        }

        /* Top Controls */
        .top-controls {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: var(--bg-color);
            border-bottom: 1px solid var(--border-color);
            padding: 10px 30px;
            z-index: 1000;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background-color 0.3s;
        }

        .nav-links {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }

        .nav-links a {
            color: var(--subheader-color);
            text-decoration: none;
            font-size: 0.9em;
            transition: color 0.2s;
        }

        .nav-links a:hover {
            color: var(--header-color);
        }

        .mode-toggle {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
        }

        .mode-toggle input { display: none; }

        .mode-toggle label {
            font-size: 0.9em;
            color: var(--subheader-color);
            cursor: pointer;
        }

        .content-spacer {
            height: 60px;
        }

        /* Hero Section */
        .hero {
            text-align: center;
            padding: 40px 20px;
            background: linear-gradient(135deg, var(--card-bg) 0%, var(--container-bg) 100%);
            border-radius: 16px;
            margin-bottom: 40px;
            border: 1px solid var(--border-color);
        }

        .hero-stats {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        .hero-stat {
            text-align: center;
        }

        .hero-stat-value {
            font-size: 2.5em;
            font-weight: 700;
            font-family: var(--font-heading);
            color: var(--header-color);
        }

        .hero-stat-label {
            font-size: 0.9em;
            color: var(--subheader-color);
        }

        /* Cards */
        .card {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 25px;
            margin: 20px 0;
        }

        .card-title {
            font-family: var(--font-heading);
            font-size: 1.1em;
            color: var(--header-color);
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
        }

        /* Info boxes */
        .info-box {
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid;
        }

        .info-box.concept {
            background: rgba(106, 140, 175, 0.1);
            border-color: var(--neutral-color);
        }

        .info-box.example {
            background: rgba(74, 156, 109, 0.1);
            border-color: var(--positive-color);
        }

        .info-box.important {
            background: rgba(199, 80, 80, 0.1);
            border-color: var(--negative-color);
        }

        .info-box-title {
            font-weight: 700;
            margin-bottom: 8px;
            color: var(--header-color);
        }

        /* Flow Diagram Container */
        .diagram-container {
            background: var(--container-bg);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 30px;
            margin: 30px 0;
            overflow-x: auto;
        }

        .diagram-container svg {
            display: block;
            margin: 0 auto;
            max-width: 100%;
            height: auto;
        }

        .diagram-caption {
            text-align: center;
            font-size: 0.9em;
            color: var(--subheader-color);
            margin-top: 15px;
            font-style: italic;
        }

        /* Grid layouts */
        .grid-2 {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .grid-3 {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .grid-4 {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        /* Dimension cards */
        .dimension-card {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 15px;
            transition: transform 0.2s;
        }

        .dimension-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px var(--shadow-color);
        }

        .dimension-card.helpful {
            border-left: 4px solid var(--positive-color);
        }

        .dimension-card.unhelpful {
            border-left: 4px solid var(--negative-color);
        }

        .dimension-card.neutral {
            border-left: 4px solid var(--neutral-color);
        }

        .dimension-name {
            font-weight: 700;
            color: var(--header-color);
            margin-bottom: 5px;
        }

        .dimension-weight {
            font-size: 0.8em;
            padding: 2px 8px;
            border-radius: 10px;
            background: var(--chart-bg);
            color: var(--text-color);
            float: right;
        }

        /* Scoring visualization */
        .score-breakdown {
            display: flex;
            align-items: center;
            gap: 30px;
            flex-wrap: wrap;
            justify-content: center;
            margin: 30px 0;
        }

        .score-pie {
            width: 200px;
            height: 200px;
        }

        .score-legend {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
        }

        .legend-text {
            font-size: 0.95em;
        }

        .legend-percent {
            font-weight: 700;
            color: var(--header-color);
        }

        /* Formula box */
        .formula-box {
            background: var(--chart-bg);
            border-radius: 8px;
            padding: 20px 30px;
            font-family: 'Courier New', monospace;
            font-size: 1.1em;
            text-align: center;
            margin: 20px 0;
            overflow-x: auto;
        }

        .formula-box .operator {
            color: var(--subheader-color);
            padding: 0 5px;
        }

        .formula-box .weight {
            color: var(--positive-color);
            font-weight: 700;
        }

        .formula-box .component {
            color: var(--header-color);
        }

        /* Badge */
        .badge {
            display: inline-block;
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: 600;
            color: white;
            margin: 2px;
        }

        .badge-helpful { background: var(--positive-color); }
        .badge-unhelpful { background: var(--negative-color); }
        .badge-neutral { background: var(--neutral-color); }
        .badge-accent { background: var(--accent-1); }
        .badge-accent2 { background: var(--accent-2); }
        .badge-accent3 { background: var(--accent-3); }

        /* Table */
        .styled-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 0.95em;
        }

        .styled-table th,
        .styled-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }

        .styled-table th {
            background: var(--chart-bg);
            font-family: var(--font-heading);
            color: var(--header-color);
            font-weight: 600;
        }

        .styled-table tr:hover {
            background: var(--hover-bg);
        }

        /* Section numbers */
        .section-number {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 36px;
            height: 36px;
            background: var(--header-color);
            color: var(--bg-color);
            border-radius: 50%;
            font-family: var(--font-heading);
            font-weight: 700;
            font-size: 1.1em;
            margin-right: 12px;
        }

        body.dark-mode .section-number {
            background: var(--accent-border-color);
            color: var(--text-color);
        }

        /* Footer */
        .footer {
            margin-top: 60px;
            padding: 30px;
            background: var(--card-bg);
            border-radius: 12px;
            border: 1px solid var(--border-color);
            text-align: center;
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 30px;
            flex-wrap: wrap;
            margin-top: 15px;
        }

        .footer-links a {
            color: var(--neutral-color);
            text-decoration: none;
        }

        .footer-links a:hover {
            text-decoration: underline;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .main-container { padding: 15px; }
            h1 { font-size: 2em; }
            h2 { font-size: 1.5em; }
            .hero-stats { gap: 20px; }
            .hero-stat-value { font-size: 2em; }
            .nav-links { display: none; }
            .top-controls { justify-content: flex-end; }
            .grid-2, .grid-3, .grid-4 { grid-template-columns: 1fr; }
            .score-breakdown { flex-direction: column; }
        }

        /* Smooth scroll */
        html {
            scroll-behavior: smooth;
        }

        /* Anchor offset for fixed header */
        section[id] {
            scroll-margin-top: 70px;
        }
    </style>
</head>
<body>
    <div class="top-controls">
        <nav class="nav-links">
            <a href="#overview">Overview</a>
            <a href="#dataset">Dataset</a>
            <a href="#scenario">Scenario</a>
            <a href="#state">State Model</a>
            <a href="#conversation">Conversation</a>
            <a href="#judging">Judging</a>
            <a href="#scoring">Scoring</a>
        </nav>
        <div class="mode-toggle">
            <input type="checkbox" id="darkModeToggle">
            <label for="darkModeToggle" id="toggleLabel">Light Mode</label>
        </div>
    </div>

    <div class="content-spacer"></div>

    <div class="main-container">
        <!-- Hero Section -->
        <div class="hero">
            <h1>EQ-Bench 4</h1>
            <p class="subtitle">
                A benchmark for measuring AI emotional intelligence through realistic, dynamic conversations with simulated personas facing real psychological challenges.
            </p>
        </div>

        <!-- Section 1: Overview -->
        <section id="overview">
            <h2><span class="section-number">1</span>What is EQ-Bench?</h2>

            <p>
                EQ-Bench 4 evaluates how well AI models handle emotionally complex conversations. It involves a roleplay conversation with a simulated persona who seeks support for a difficult situation&mdash;and the AI must build trust, understand hidden issues, and provide genuine help.
            </p>

            <div class="info-box concept">
                <div class="info-box-title">The Core Idea</div>
                <p style="margin-bottom: 0;">
                    EQ-Bench loosely mirrors the format of an <strong>OSCE</strong> (Objective Structured Clinical Examination), which is a kind of roleplay evaluation used
                    in medical training in which candidates conduct short clinical interviews with
                    <strong>standardized patients</strong> (trained actors). The goal of an OSCE is to show you can
                    build rapport quickly, think on your feet, ask the right questions, notice what&rsquo;s unsaid, and respond in a way that helps. This kind of test strongly assesses <strong>active, applied abilities</strong>.
                </p>
                <p style="margin-bottom: 0; margin-top: 12px;">
                    Our evaluation mirrors this structure, but with more variety in roles: <strong>friend, partner, therapist, teacher, parent.</strong> Each scenario defines a standardized &ldquo;persona&rdquo; profile (traits,
                    presenting complaint, and hidden underlying core issue). The evaluated model runs a fixed-length conversation with this simulated persona, which is "acted" by another AI model. The persona model is instructed to behave faithfully to their assigned traits and their current emotional state.
                </p>
                <p>
                    After the interaction, judge models score both the <em>process</em> (how the
                    conversation was handled) and the <em>outcome</em> (whether the persona ends up feeling safer, more trusting, and closer to
                    progress on the real issue).
                </p>
                </div>


            <div class="diagram-container">
                <svg viewBox="0 0 900 280" xmlns="http://www.w3.org/2000/svg">
                    <!-- Gradients and markers -->
                    <defs>
                        <linearGradient id="grad1" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#6a8caf;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#5a7c9f;stop-opacity:1" />
                        </linearGradient>
                        <linearGradient id="grad2" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#7c5295;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#6c4285;stop-opacity:1" />
                        </linearGradient>
                        <linearGradient id="grad3" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#5a8c8c;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#4a7c7c;stop-opacity:1" />
                        </linearGradient>
                        <linearGradient id="grad4" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#4a9c6d;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#3a8c5d;stop-opacity:1" />
                        </linearGradient>
                        <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                            <polygon points="0 0, 10 3.5, 0 7" fill="#7a6a60" />
                        </marker>
                        <marker id="arrowhead-loop" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto">
                            <polygon points="0 0, 10 3.5, 0 7" fill="#c9a227" />
                        </marker>
                    </defs>

                    <!-- Dataset Generation (separate, offline) -->
                    <rect x="20" y="20" width="200" height="70" rx="10" fill="url(#grad1)" />
                    <text x="120" y="50" text-anchor="middle" fill="white" font-family="Merriweather, serif" font-size="13" font-weight="700">Dataset Generation</text>
                    <text x="120" y="70" text-anchor="middle" fill="#c0d8e8" font-family="Lora, serif" font-size="10">(offline, one-time)</text>
                    <text x="120" y="115" text-anchor="middle" fill="#7a6a60" font-family="Lora, serif" font-size="10">Create test/train/eval</text>
                    <text x="120" y="128" text-anchor="middle" fill="#7a6a60" font-family="Lora, serif" font-size="10">scenario datasets</text>

                    <!-- Divider line -->
                    <line x1="250" y1="20" x2="250" y2="130" stroke="#d3c0a5" stroke-width="2" stroke-dasharray="5,5" />

                    <!-- EVALUATION FLOW label -->
                    <text x="570" y="18" text-anchor="middle" fill="#5c4033" font-family="Merriweather, serif" font-size="11" font-weight="700">EVALUATION FLOW</text>

                    <!-- Box 1: Conversation Turns (with loop) -->
                    <rect x="280" y="40" width="160" height="80" rx="10" fill="url(#grad2)" />
                    <text x="360" y="70" text-anchor="middle" fill="white" font-family="Merriweather, serif" font-size="13" font-weight="700">Conversation</text>
                    <text x="360" y="90" text-anchor="middle" fill="white" font-family="Lora, serif" font-size="11">8 Turns</text>

                    <!-- Loop arrow for state update (on top of box) -->
                    <text x="360" y="5" text-anchor="middle" fill="#c9a227" font-family="Lora, serif" font-size="9">persona state update</text>
                    <path d="M 320 40 Q 320 15, 360 15 Q 400 15, 400 20" fill="none" stroke="#c9a227" stroke-width="2" />
                    <polygon points="393,20 407,20 400,40" fill="#c9a227" />

                    <!-- Arrow to Judging -->
                    <line x1="440" y1="80" x2="530" y2="80" stroke="#7a6a60" stroke-width="2" marker-end="url(#arrowhead)" />

                    <!-- Box 2: Judging & Debrief -->
                    <rect x="535" y="40" width="150" height="80" rx="10" fill="url(#grad3)" />
                    <text x="610" y="70" text-anchor="middle" fill="white" font-family="Merriweather, serif" font-size="13" font-weight="700">Judging</text>
                    <text x="610" y="90" text-anchor="middle" fill="white" font-family="Lora, serif" font-size="11">& Debrief</text>

                    <!-- Arrow to Score -->
                    <line x1="685" y1="80" x2="720" y2="80" stroke="#7a6a60" stroke-width="2" marker-end="url(#arrowhead)" />

                    <!-- Box 3: Final Score -->
                    <rect x="725" y="40" width="150" height="80" rx="10" fill="url(#grad4)" />
                    <text x="800" y="70" text-anchor="middle" fill="white" font-family="Merriweather, serif" font-size="13" font-weight="700">Final</text>
                    <text x="800" y="90" text-anchor="middle" fill="white" font-family="Lora, serif" font-size="11">Score</text>

                    <!-- Labels below -->
                    <text x="360" y="145" text-anchor="middle" fill="#7a6a60" font-family="Lora, serif" font-size="10">Evaluated AI model talks with</text>
                    <text x="360" y="158" text-anchor="middle" fill="#7a6a60" font-family="Lora, serif" font-size="10">simulated persona</text>

                    <text x="610" y="145" text-anchor="middle" fill="#7a6a60" font-family="Lora, serif" font-size="10">Evaluate quality</text>
                    <text x="610" y="158" text-anchor="middle" fill="#7a6a60" font-family="Lora, serif" font-size="10">& understanding</text>

                    <text x="800" y="145" text-anchor="middle" fill="#7a6a60" font-family="Lora, serif" font-size="10">Combine into</text>
                    <text x="800" y="158" text-anchor="middle" fill="#7a6a60" font-family="Lora, serif" font-size="10">0-10 score</text>

                    <!-- Turn explanation -->
                    <rect x="280" y="190" width="595" height="70" rx="8" fill="#f9f6f0" stroke="#d3c0a5" stroke-width="1" />
                    <text x="577" y="215" text-anchor="middle" fill="#5c4033" font-family="Merriweather, serif" font-size="11" font-weight="700">What is a "turn"?</text>
                    <text x="577" y="235" text-anchor="middle" fill="#7a6a60" font-family="Lora, serif" font-size="10">Each turn = one assistant response + one user persona response. Both sides get 8 turns each (16 messages total).</text>
                </svg>
        </section>

        <!-- Section 2: Dataset Generation -->
        <section id="dataset">
            <h2><span class="section-number">2</span>Dataset Generation</h2>

            <p>
                Before any conversations happen, EQ-Bench generates a diverse set of <strong>scenarios</strong>&mdash;each representing a unique person with specific psychological traits, issues, and circumstances. This is done by sampling from a carefully curated <strong>registry</strong> of psychological building blocks.
            </p>

            <div class="diagram-container">
                <svg viewBox="0 0 800 320" xmlns="http://www.w3.org/2000/svg">
                    <!-- Registry box -->
                    <rect x="30" y="20" width="200" height="280" rx="10" fill="#f0ebe3" stroke="#d3c0a5" stroke-width="2" />
                    <text x="130" y="50" text-anchor="middle" fill="#5c4033" font-family="Merriweather, serif" font-size="14" font-weight="700">Registry Catalog</text>
                    <text x="130" y="68" text-anchor="middle" fill="#7a6a60" font-family="Lora, serif" font-size="10">(46 YAML files)</text>

                    <!-- Registry items -->
                    <rect x="45" y="85" width="170" height="30" rx="5" fill="#6a8caf" />
                    <text x="130" y="105" text-anchor="middle" fill="white" font-family="Lora, serif" font-size="11">Core Issues</text>

                    <rect x="45" y="120" width="170" height="30" rx="5" fill="#7c5295" />
                    <text x="130" y="140" text-anchor="middle" fill="white" font-family="Lora, serif" font-size="11">Presenting Issues</text>

                    <rect x="45" y="155" width="170" height="30" rx="5" fill="#c9a227" />
                    <text x="130" y="175" text-anchor="middle" fill="white" font-family="Lora, serif" font-size="11">Persona Traits</text>

                    <rect x="45" y="190" width="170" height="30" rx="5" fill="#5a8c8c" />
                    <text x="130" y="210" text-anchor="middle" fill="white" font-family="Lora, serif" font-size="11">Modifiers</text>

                    <rect x="45" y="225" width="170" height="30" rx="5" fill="#4a9c6d" />
                    <text x="130" y="245" text-anchor="middle" fill="white" font-family="Lora, serif" font-size="11">Adjacent Attributes</text>

                    <rect x="45" y="260" width="170" height="30" rx="5" fill="#c75050" />
                    <text x="130" y="280" text-anchor="middle" fill="white" font-family="Lora, serif" font-size="11">Relationships</text>

                    <!-- Arrow to generator -->
                    <line x1="230" y1="160" x2="290" y2="160" stroke="#7a6a60" stroke-width="2" marker-end="url(#arrowhead)" />
                    <text x="260" y="150" text-anchor="middle" fill="#7a6a60" font-family="Lora, serif" font-size="10">weighted</text>
                    <text x="260" y="162" text-anchor="middle" fill="#7a6a60" font-family="Lora, serif" font-size="10">sampling</text>

                    <!-- Generator box -->
                    <rect x="295" y="80" width="180" height="160" rx="10" fill="#f9f6f0" stroke="#d3c0a5" stroke-width="2" />
                    <text x="385" y="110" text-anchor="middle" fill="#5c4033" font-family="Merriweather, serif" font-size="14" font-weight="700">Scenario</text>
                    <text x="385" y="128" text-anchor="middle" fill="#5c4033" font-family="Merriweather, serif" font-size="14" font-weight="700">Generator</text>

                    <text x="385" y="155" text-anchor="middle" fill="#7a6a60" font-family="Lora, serif" font-size="11">1. Pick core issue</text>
                    <text x="385" y="172" text-anchor="middle" fill="#7a6a60" font-family="Lora, serif" font-size="11">2. Find compatible presenting</text>
                    <text x="385" y="189" text-anchor="middle" fill="#7a6a60" font-family="Lora, serif" font-size="11">3. Select traits & modifiers</text>
                    <text x="385" y="206" text-anchor="middle" fill="#7a6a60" font-family="Lora, serif" font-size="11">4. Generate initial state</text>
                    <text x="385" y="223" text-anchor="middle" fill="#7a6a60" font-family="Lora, serif" font-size="11">5. Validate compatibility</text>

                    <!-- Arrow to dataset -->
                    <line x1="475" y1="160" x2="535" y2="160" stroke="#7a6a60" stroke-width="2" marker-end="url(#arrowhead)" />

                    <!-- Dataset box -->
                    <rect x="540" y="60" width="230" height="200" rx="10" fill="#f0ebe3" stroke="#d3c0a5" stroke-width="2" />
                    <text x="655" y="90" text-anchor="middle" fill="#5c4033" font-family="Merriweather, serif" font-size="14" font-weight="700">Dataset (JSON)</text>

                    <!-- Dataset structure preview -->
                    <rect x="555" y="105" width="200" height="140" rx="5" fill="#fffcf7" stroke="#e0dcd1" />
                    <text x="565" y="125" fill="#7a6a60" font-family="monospace" font-size="10">{</text>
                    <text x="575" y="140" fill="#7a6a60" font-family="monospace" font-size="10">"docs": [</text>
                    <text x="585" y="155" fill="#6a8caf" font-family="monospace" font-size="10">{ scenario_1 },</text>
                    <text x="585" y="170" fill="#7c5295" font-family="monospace" font-size="10">{ scenario_2 },</text>
                    <text x="585" y="185" fill="#c9a227" font-family="monospace" font-size="10">{ scenario_3 },</text>
                    <text x="585" y="200" fill="#7a6a60" font-family="monospace" font-size="10">...</text>
                    <text x="575" y="215" fill="#7a6a60" font-family="monospace" font-size="10">]</text>
                    <text x="565" y="230" fill="#7a6a60" font-family="monospace" font-size="10">}</text>
                </svg>
                <div class="diagram-caption">The registry provides building blocks; the generator assembles them into complete scenarios</div>
            </div>

            <div class="info-box important">
                <div class="info-box-title">No Core Issue Overlap Between Datasets</div>
                <p style="margin-bottom: 0;">
                    The generator ensures that <strong>core issues do not overlap</strong> between test, train, and private held-out evaluation datasets. This prevents models from being trained on the same underlying issues they'll be evaluated on, ensuring fair benchmark results.
                </p>
            </div>

            <h3>What's in the Registry?</h3>

            <div class="grid-2">
                <div class="card">
                    <div class="card-title">Core Issues</div>
                    <p>The <em>real</em> underlying problem the person is dealing with, often hidden even from themselves. Categories:</p>
                    <p>
                        <span class="badge badge-neutral">trauma</span>
                        <span class="badge badge-accent">relationship</span>
                        <span class="badge badge-unhelpful">mental_health</span>
                        <span class="badge badge-accent2">share_or_vent</span>
                        <span class="badge badge-accent3">personal</span>
                        <span class="badge badge-neutral">dispute</span>
                        <span class="badge badge-accent">exploring_feelings</span>
                        <span class="badge badge-unhelpful">distress</span>
                        <span class="badge badge-accent2">schooling</span>
                        <span class="badge badge-accent3">work</span>
                        <span class="badge badge-neutral">parenting_or_caregiving</span>
                        <span class="badge badge-accent">teen</span>
                        <span class="badge badge-unhelpful">young_adult</span>
                        <span class="badge badge-accent2">other</span>
                    </p>
                </div>
                <div class="card">
                    <div class="card-title">Presenting Issues</div>
                    <p>A prewritten conversation starter from the persona's perspective. It's typically something vaguely tangential to or hinting at the core issue&mdash;the opening message that kicks off the conversation.</p>
                    <p style="font-style: italic; color: var(--subheader-color);">
                        Example: "I've been having trouble sleeping lately" (while the core issue might be anxiety about job loss).
                    </p>
                </div>
                <div class="card">
                    <div class="card-title">Persona Traits</div>
                    <p>Three behavioral dimensions that shape how the person interacts:</p>
                    <ul style="margin: 0; padding-left: 20px;">
                        <li><strong>Trust Style</strong> &ndash; How they build/withhold trust</li>
                        <li><strong>Defense Style</strong> &ndash; Psychological defenses (sarcasm, intellectualizing, etc.)</li>
                        <li><strong>Help-Seeking Stance</strong> &ndash; Genuinely seeking help, testing, or just venting</li>
                    </ul>
                </div>
                <div class="card">
                    <div class="card-title">Modifiers</div>
                    <p>Demographic and personality factors that add context:</p>
                    <ul style="margin: 0; padding-left: 20px;">
                        <li>Age, gender, sexuality</li>
                        <li>Cognitive style, emotional tendencies</li>
                        <li>Background factors (trauma history, family dynamics)</li>
                    </ul>
                </div>
            </div>

            <div class="info-box example">
                <div class="info-box-title">Example: Why Compatibility Matters</div>
                <p style="margin-bottom: 0;">
                    The generator enforces logical constraints. For example, a "parenting burnout" core issue requires a modifier indicating the person has children. This ensures scenarios are psychologically coherent.
                </p>
            </div>
        </section>

        <!-- Section 3: Scenario Anatomy -->
        <section id="scenario">
            <h2><span class="section-number">3</span>Anatomy of a Scenario</h2>

            <p>
                Each scenario is a complete profile of a person seeking help. Let's break down what makes up a scenario:
            </p>

            <div class="diagram-container">
                <svg viewBox="0 0 800 450" xmlns="http://www.w3.org/2000/svg">
                    <!-- Central scenario box -->
                    <rect x="280" y="180" width="240" height="90" rx="10" fill="#5c4033" />
                    <text x="400" y="215" text-anchor="middle" fill="white" font-family="Merriweather, serif" font-size="16" font-weight="700">Scenario Config</text>
                    <text x="400" y="240" text-anchor="middle" fill="#d3c0a5" font-family="Lora, serif" font-size="12">Complete persona profile</text>
                    <text x="400" y="258" text-anchor="middle" fill="#d3c0a5" font-family="Lora, serif" font-size="12">ready for evaluation</text>

                    <!-- Presenting Issue (top left) -->
                    <rect x="30" y="30" width="180" height="100" rx="8" fill="#7c5295" />
                    <text x="120" y="60" text-anchor="middle" fill="white" font-family="Merriweather, serif" font-size="12" font-weight="700">Presenting Issue</text>
                    <text x="120" y="82" text-anchor="middle" fill="#e0d0f0" font-family="Lora, serif" font-size="10">Conversation starter:</text>
                    <text x="120" y="98" text-anchor="middle" fill="white" font-family="Lora, serif" font-size="11">"I can't focus at work"</text>
                    <text x="120" y="118" text-anchor="middle" fill="#c0b0d0" font-family="Lora, serif" font-size="9">Severity: moderate</text>
                    <line x1="210" y1="100" x2="280" y2="200" stroke="#7c5295" stroke-width="2" />

                    <!-- Core Issue (top right) -->
                    <rect x="590" y="30" width="180" height="100" rx="8" fill="#c75050" />
                    <text x="680" y="60" text-anchor="middle" fill="white" font-family="Merriweather, serif" font-size="12" font-weight="700">Core Issue</text>
                    <text x="680" y="82" text-anchor="middle" fill="#f0d0d0" font-family="Lora, serif" font-size="10">The real problem:</text>
                    <text x="680" y="98" text-anchor="middle" fill="white" font-family="Lora, serif" font-size="11">Burnout & exhaustion</text>
                    <text x="680" y="118" text-anchor="middle" fill="#d0b0b0" font-family="Lora, serif" font-size="9">Category: mental_health</text>
                    <line x1="590" y1="100" x2="520" y2="200" stroke="#c75050" stroke-width="2" />

                    <!-- Trust Style (left) -->
                    <rect x="30" y="180" width="180" height="80" rx="8" fill="#c9a227" />
                    <text x="120" y="210" text-anchor="middle" fill="white" font-family="Merriweather, serif" font-size="12" font-weight="700">Trust Style</text>
                    <text x="120" y="232" text-anchor="middle" fill="white" font-family="Lora, serif" font-size="11">"Needs Proof First"</text>
                    <text x="120" y="250" text-anchor="middle" fill="#f0e0b0" font-family="Lora, serif" font-size="9">Skeptical until shown competence</text>
                    <line x1="210" y1="220" x2="280" y2="220" stroke="#c9a227" stroke-width="2" />

                    <!-- Defense Style (right) -->
                    <rect x="590" y="180" width="180" height="80" rx="8" fill="#5a8c8c" />
                    <text x="680" y="210" text-anchor="middle" fill="white" font-family="Merriweather, serif" font-size="12" font-weight="700">Defense Style</text>
                    <text x="680" y="232" text-anchor="middle" fill="white" font-family="Lora, serif" font-size="11">"Intellectualizing"</text>
                    <text x="680" y="250" text-anchor="middle" fill="#b0d0d0" font-family="Lora, serif" font-size="9">Analyzes to avoid feeling</text>
                    <line x1="590" y1="220" x2="520" y2="220" stroke="#5a8c8c" stroke-width="2" />

                    <!-- Help-Seeking (bottom left) -->
                    <rect x="30" y="320" width="180" height="80" rx="8" fill="#4a9c6d" />
                    <text x="120" y="350" text-anchor="middle" fill="white" font-family="Merriweather, serif" font-size="12" font-weight="700">Help-Seeking</text>
                    <text x="120" y="372" text-anchor="middle" fill="white" font-family="Lora, serif" font-size="11">"Genuinely Seeking"</text>
                    <text x="120" y="390" text-anchor="middle" fill="#b0e0c0" font-family="Lora, serif" font-size="9">Actually wants to improve</text>
                    <line x1="210" y1="350" x2="280" y2="260" stroke="#4a9c6d" stroke-width="2" />

                    <!-- Modifiers (bottom center-left) -->
                    <rect x="250" y="320" width="140" height="100" rx="8" fill="#6a8caf" />
                    <text x="320" y="350" text-anchor="middle" fill="white" font-family="Merriweather, serif" font-size="12" font-weight="700">Modifiers</text>
                    <text x="320" y="372" text-anchor="middle" fill="white" font-family="Lora, serif" font-size="10">Age: 35-44</text>
                    <text x="320" y="388" text-anchor="middle" fill="white" font-family="Lora, serif" font-size="10">Gender: Male</text>
                    <text x="320" y="404" text-anchor="middle" fill="white" font-family="Lora, serif" font-size="10">Trait: Perfectionist</text>
                    <line x1="320" y1="320" x2="370" y2="270" stroke="#6a8caf" stroke-width="2" />

                    <!-- Relationship (bottom center-right) -->
                    <rect x="410" y="320" width="140" height="100" rx="8" fill="#8c6a7a" />
                    <text x="480" y="350" text-anchor="middle" fill="white" font-family="Merriweather, serif" font-size="12" font-weight="700">Relationship</text>
                    <text x="480" y="375" text-anchor="middle" fill="white" font-family="Lora, serif" font-size="11">therapist</text>
                    <text x="480" y="395" text-anchor="middle" fill="#e0d0d8" font-family="Lora, serif" font-size="9">Who they're talking to</text>
                    <line x1="450" y1="320" x2="420" y2="270" stroke="#8c6a7a" stroke-width="2" />

                    <!-- Initial State (bottom right) -->
                    <rect x="590" y="320" width="180" height="100" rx="8" fill="#a05a5a" />
                    <text x="680" y="350" text-anchor="middle" fill="white" font-family="Merriweather, serif" font-size="12" font-weight="700">Initial State</text>
                    <text x="680" y="372" text-anchor="middle" fill="#f0d0d0" font-family="Lora, serif" font-size="10">trusting: 3.0</text>
                    <text x="680" y="388" text-anchor="middle" fill="#f0d0d0" font-family="Lora, serif" font-size="10">anxious: 6.5</text>
                    <text x="680" y="404" text-anchor="middle" fill="#f0d0d0" font-family="Lora, serif" font-size="10">frustrated: 5.0</text>
                    <line x1="590" y1="350" x2="520" y2="260" stroke="#a05a5a" stroke-width="2" />

                    <!-- Adjacent Attributes (top center) -->
                    <rect x="310" y="30" width="180" height="100" rx="8" fill="#7a6a9c" />
                    <text x="400" y="55" text-anchor="middle" fill="white" font-family="Merriweather, serif" font-size="11" font-weight="700">Adjacent Attributes</text>
                    <text x="400" y="75" text-anchor="middle" fill="#d0c0e0" font-family="Lora, serif" font-size="9">Observable clues about core issue:</text>
                    <text x="400" y="95" text-anchor="middle" fill="white" font-family="Lora, serif" font-size="10">"Works late most nights"</text>
                    <text x="400" y="112" text-anchor="middle" fill="white" font-family="Lora, serif" font-size="10">"Skips lunch breaks"</text>
                    <line x1="400" y1="130" x2="400" y2="180" stroke="#7a6a9c" stroke-width="2" />
                </svg>
                <div class="diagram-caption">All the components that define a unique persona and their situation</div>
            </div>

            <div class="info-box important">
                <div class="info-box-title">The Hidden vs. Visible Distinction</div>
                <p style="margin-bottom: 0;">
                    A key design principle: the <strong>presenting issue</strong> and <strong>adjacent attributes</strong> are what the persona might naturally share. The <strong>core issue</strong> is hidden&mdash;even from the persona in some cases. Good AI performance means recognizing clues and gently exploring deeper, not just responding to surface complaints.
                </p>
            </div>
        </section>

        <!-- Section 4: Persona State Model -->
        <section id="state">
            <h2><span class="section-number">4</span>The Persona State Model</h2>

            <p>
                Each persona has an internal emotional state tracked across <strong>20 dimensions</strong>. This state starts at initial values and <em>changes during the conversation</em> based on how well the AI responds. The state change is the primary measure of how helpful the AI was.
            </p>

            <div class="info-box concept">
                <div class="info-box-title">Helpful vs. Unhelpful Dimensions</div>
                <p style="margin-bottom: 0;">
                    Dimensions are labeled as "helpful" or "unhelpful" based on the <strong>evaluated model's task</strong>: to support the persona, build trust with them, learn about them, and help them make progress on their core issue. "Helpful" dimensions should increase during a successful conversation; "unhelpful" dimensions should decrease.
                </p>
            </div>

            <h3>Helpful Dimensions <span class="badge badge-helpful">Higher = Better</span></h3>
            <p>These should <em>increase</em> during a good conversation:</p>

            <div class="grid-4">
                <div class="dimension-card helpful">
                    <div class="dimension-name">Trusting <span class="dimension-weight">3.0x weight</span></div>
                </div>
                <div class="dimension-card helpful">
                    <div class="dimension-name">Safe <span class="dimension-weight">3.0x weight</span></div>
                </div>
                <div class="dimension-card helpful">
                    <div class="dimension-name">Understood <span class="dimension-weight">2.0x weight</span></div>
                </div>
                <div class="dimension-card helpful">
                    <div class="dimension-name">Engaged <span class="dimension-weight">1.0x weight</span></div>
                </div>
                <div class="dimension-card helpful">
                    <div class="dimension-name">Curious <span class="dimension-weight">1.0x weight</span></div>
                </div>
                <div class="dimension-card helpful">
                    <div class="dimension-name">Motivated <span class="dimension-weight">1.0x weight</span></div>
                </div>
                <div class="dimension-card helpful">
                    <div class="dimension-name">Progress on Core Issue <span class="dimension-weight">3.0x weight</span></div>
                </div>
            </div>

            <h3>Unhelpful Dimensions <span class="badge badge-unhelpful">Lower = Better</span></h3>
            <p>These should <em>decrease</em> during a good conversation:</p>

            <div class="grid-4">
                <div class="dimension-card unhelpful">
                    <div class="dimension-name">Resistant <span class="dimension-weight">2.0x weight</span></div>
                </div>
                <div class="dimension-card unhelpful">
                    <div class="dimension-name">Frustrated <span class="dimension-weight">2.0x weight</span></div>
                </div>
                <div class="dimension-card unhelpful">
                    <div class="dimension-name">Oppositional <span class="dimension-weight">1.0x weight</span></div>
                </div>
                <div class="dimension-card unhelpful">
                    <div class="dimension-name">Anxious <span class="dimension-weight">1.0x weight</span></div>
                </div>
                <div class="dimension-card unhelpful">
                    <div class="dimension-name">Paranoid <span class="dimension-weight">1.0x weight</span></div>
                </div>
                <div class="dimension-card unhelpful">
                    <div class="dimension-name">Overwhelmed <span class="dimension-weight">1.0x weight</span></div>
                </div>
                <div class="dimension-card unhelpful">
                    <div class="dimension-name">Distressed <span class="dimension-weight">1.0x weight</span></div>
                </div>
                <div class="dimension-card unhelpful">
                    <div class="dimension-name">Ashamed <span class="dimension-weight">1.0x weight</span></div>
                </div>
                <div class="dimension-card unhelpful">
                    <div class="dimension-name">Insecure <span class="dimension-weight">1.0x weight</span></div>
                </div>
                <div class="dimension-card unhelpful">
                    <div class="dimension-name">Angry <span class="dimension-weight">1.0x weight</span></div>
                </div>
                <div class="dimension-card unhelpful">
                    <div class="dimension-name">Irritated <span class="dimension-weight">1.0x weight</span></div>
                </div>
            </div>

            <h3>Neutral Dimensions <span class="badge badge-neutral">Tracked, Not Scored</span></h3>

            <div class="grid-4">
                <div class="dimension-card neutral">
                    <div class="dimension-name">Vulnerable</div>
                </div>
                <div class="dimension-card neutral">
                    <div class="dimension-name">Sad</div>
                </div>
            </div>

            <div class="info-box concept">
                <div class="info-box-title">Weighted Scoring</div>
                <p style="margin-bottom: 0;">
                    Not all dimensions are equal. <strong>Trust</strong>, <strong>Safety</strong>, and <strong>Progress on Core Issue</strong> are weighted 3x because they're most indicative of meaningful therapeutic progress. The weights reflect which emotional changes matter most for genuine help.
                </p>
            </div>
        </section>

        <!-- Section 5: Conversation Execution -->
        <section id="conversation">
            <h2><span class="section-number">5</span>Conversation Execution</h2>

            <p>
                The heart of EQ-Bench is an <strong>8-turn conversation</strong> between the AI being evaluated and a simulated persona. A "turn" means one response from each side&mdash;so each participant sends 8 messages (16 total). The persona is played by another AI model that follows the scenario's traits and updates its emotional state after each exchange.
            </p>

            <div class="diagram-container">
                <svg viewBox="0 0 800 480" xmlns="http://www.w3.org/2000/svg">
                    <!-- Title -->
                    <text x="400" y="30" text-anchor="middle" fill="#5c4033" font-family="Merriweather, serif" font-size="16" font-weight="700">Conversation Flow</text>

                    <!-- Evaluated Model box -->
                    <rect x="50" y="50" width="160" height="60" rx="8" fill="#4a9c6d" />
                    <text x="130" y="75" text-anchor="middle" fill="white" font-family="Merriweather, serif" font-size="12" font-weight="700">Evaluated Model</text>
                    <text x="130" y="95" text-anchor="middle" fill="#b0e0c0" font-family="Lora, serif" font-size="10">(AI being tested)</text>

                    <!-- Persona Simulator box -->
                    <rect x="590" y="50" width="160" height="60" rx="8" fill="#7c5295" />
                    <text x="670" y="75" text-anchor="middle" fill="white" font-family="Merriweather, serif" font-size="12" font-weight="700">Persona Simulator</text>
                    <text x="670" y="95" text-anchor="middle" fill="#d0c0e0" font-family="Lora, serif" font-size="10">(Plays the person)</text>

                    <!-- Presenting Issue (conversation starter, no turn label) -->
                    <rect x="450" y="130" width="300" height="50" rx="6" fill="#e8d8f0" stroke="#7c5295" stroke-width="2" />
                    <text x="465" y="152" fill="#6c4285" font-family="Lora, serif" font-size="10" font-weight="700">User (Persona) - Conversation Starter:</text>
                    <text x="465" y="168" fill="#3a3a3a" font-family="Lora, serif" font-size="11">"I've been having trouble focusing at work lately..."</text>

                    <!-- Arrow to assistant -->
                    <path d="M 450 155 L 370 155 L 370 200 L 350 200" fill="none" stroke="#7a6a60" stroke-width="2" marker-end="url(#arrowhead)" />

                    <!-- Turn 1: Assistant responds -->
                    <rect x="70" y="190" width="280" height="50" rx="6" fill="#d0f0d8" stroke="#4a9c6d" stroke-width="2" />
                    <text x="85" y="212" fill="#3a8c5d" font-family="Lora, serif" font-size="10" font-weight="700">TURN 1 - Assistant:</text>
                    <text x="85" y="228" fill="#3a3a3a" font-family="Lora, serif" font-size="11">"That sounds frustrating. Can you tell me more?"</text>

                    <!-- Arrow to persona -->
                    <path d="M 350 215 L 430 215 L 430 260 L 450 260" fill="none" stroke="#7a6a60" stroke-width="2" marker-end="url(#arrowhead)" />

                    <!-- Turn 1: Persona responds with internal/state/response -->
                    <rect x="450" y="250" width="300" height="100" rx="6" fill="#e8d8f0" stroke="#7c5295" stroke-width="2" />
                    <text x="465" y="272" fill="#6c4285" font-family="Lora, serif" font-size="10" font-weight="700">TURN 1 - User (Persona):</text>
                    <text x="465" y="292" fill="#3a3a3a" font-family="Lora, serif" font-size="10">[INTERNAL] They seem interested... maybe I can</text>
                    <text x="465" y="306" fill="#3a3a3a" font-family="Lora, serif" font-size="10">share a bit more.</text>
                    <text x="465" y="324" fill="#7c5295" font-family="monospace" font-size="9">[STATE] {"trusting": 3.2, "resistant": 4.8...}</text>
                    <text x="465" y="340" fill="#3a3a3a" font-family="Lora, serif" font-size="10">[RESPONSE] "Well, it started a few weeks ago..."</text>

                    <!-- Arrow back to assistant -->
                    <path d="M 450 320 L 370 320 L 370 380 L 350 380" fill="none" stroke="#7a6a60" stroke-width="2" marker-end="url(#arrowhead)" />

                    <!-- Turn 2: Assistant responds -->
                    <rect x="70" y="370" width="280" height="50" rx="6" fill="#d0f0d8" stroke="#4a9c6d" stroke-width="2" />
                    <text x="85" y="392" fill="#3a8c5d" font-family="Lora, serif" font-size="10" font-weight="700">TURN 2 - Assistant:</text>
                    <text x="85" y="408" fill="#3a3a3a" font-family="Lora, serif" font-size="11">"It sounds like work has been really draining..."</text>

                    <!-- Dots indicating continuation -->
                    <text x="400" y="460" text-anchor="middle" fill="#7a6a60" font-family="Lora, serif" font-size="14">. . . continues for 8 turns each . . .</text>
                </svg>
                <div class="diagram-caption">The persona starts with their presenting issue, then each side takes 8 turns</div>
            </div>

            <h3>What the Persona Outputs Each Turn</h3>

            <div class="grid-3">
                <div class="card">
                    <div class="card-title">[INTERNAL]</div>
                    <p>Private reasoning about how they feel about the AI's response. Are they building trust? Feeling pushed? Considering opening up?</p>
                </div>
                <div class="card">
                    <div class="card-title">[STATE]</div>
                    <p>Updated values for all 20 emotional dimensions as JSON. This is how we track whether the conversation is helping or hurting.</p>
                </div>
                <div class="card">
                    <div class="card-title">[RESPONSE]</div>
                    <p>What the persona actually says to the AI. This is the only part the evaluated model sees.</p>
                </div>
            </div>

            <h3>Example: State Evolution Over a Conversation</h3>

            <div class="diagram-container">
                <svg viewBox="0 0 700 300" xmlns="http://www.w3.org/2000/svg">
                    <!-- Axes -->
                    <line x1="80" y1="250" x2="650" y2="250" stroke="#7a6a60" stroke-width="2" />
                    <line x1="80" y1="250" x2="80" y2="50" stroke="#7a6a60" stroke-width="2" />

                    <!-- Y-axis labels -->
                    <text x="70" y="255" text-anchor="end" fill="#7a6a60" font-family="Lora, serif" font-size="10">0</text>
                    <text x="70" y="195" text-anchor="end" fill="#7a6a60" font-family="Lora, serif" font-size="10">2</text>
                    <text x="70" y="155" text-anchor="end" fill="#7a6a60" font-family="Lora, serif" font-size="10">4</text>
                    <text x="70" y="115" text-anchor="end" fill="#7a6a60" font-family="Lora, serif" font-size="10">6</text>
                    <text x="70" y="75" text-anchor="end" fill="#7a6a60" font-family="Lora, serif" font-size="10">8</text>
                    <text x="40" y="150" text-anchor="middle" fill="#5c4033" font-family="Merriweather, serif" font-size="11" transform="rotate(-90, 40, 150)">Score</text>

                    <!-- X-axis labels (turns) -->
                    <text x="130" y="270" text-anchor="middle" fill="#7a6a60" font-family="Lora, serif" font-size="10">1</text>
                    <text x="200" y="270" text-anchor="middle" fill="#7a6a60" font-family="Lora, serif" font-size="10">2</text>
                    <text x="270" y="270" text-anchor="middle" fill="#7a6a60" font-family="Lora, serif" font-size="10">3</text>
                    <text x="340" y="270" text-anchor="middle" fill="#7a6a60" font-family="Lora, serif" font-size="10">4</text>
                    <text x="410" y="270" text-anchor="middle" fill="#7a6a60" font-family="Lora, serif" font-size="10">5</text>
                    <text x="480" y="270" text-anchor="middle" fill="#7a6a60" font-family="Lora, serif" font-size="10">6</text>
                    <text x="550" y="270" text-anchor="middle" fill="#7a6a60" font-family="Lora, serif" font-size="10">7</text>
                    <text x="620" y="270" text-anchor="middle" fill="#7a6a60" font-family="Lora, serif" font-size="10">8</text>
                    <text x="375" y="295" text-anchor="middle" fill="#5c4033" font-family="Merriweather, serif" font-size="11">Conversation Turn</text>

                    <!-- Trust line (increasing) - green -->
                    <polyline points="130,190 200,180 270,165 340,150 410,135 480,120 550,105 620,95"
                              fill="none" stroke="#4a9c6d" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" />
                    <circle cx="620" cy="95" r="5" fill="#4a9c6d" />
                    <text x="655" y="100" fill="#4a9c6d" font-family="Lora, serif" font-size="10">Trust</text>

                    <!-- Resistant line (decreasing) - red -->
                    <polyline points="130,150 200,160 270,170 340,180 410,190 480,200 550,210 620,215"
                              fill="none" stroke="#c75050" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" />
                    <circle cx="620" cy="215" r="5" fill="#c75050" />
                    <text x="655" y="220" fill="#c75050" font-family="Lora, serif" font-size="10">Resistant</text>

                    <!-- Progress line (increasing from 0) - purple -->
                    <polyline points="130,250 200,248 270,240 340,225 410,205 480,180 550,155 620,135"
                              fill="none" stroke="#7c5295" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" stroke-dasharray="8,4" />
                    <circle cx="620" cy="135" r="5" fill="#7c5295" />
                    <text x="655" y="140" fill="#7c5295" font-family="Lora, serif" font-size="10">Progress</text>

                    <!-- Title -->
                    <text x="365" y="35" text-anchor="middle" fill="#5c4033" font-family="Merriweather, serif" font-size="14" font-weight="700">Example: Good Conversation State Evolution</text>
                </svg>
                <div class="diagram-caption">In a successful conversation, trust and progress rise while resistance falls</div>
            </div>
        </section>

        <!-- Section 6: Debrief Phase -->
        <section id="debrief">
            <h2><span class="section-number">6</span>The Debrief Phase</h2>

            <p>
                After the conversation ends, the evaluated model is asked to provide a <strong>debrief assessment</strong>&mdash;a reflection on what they learned about the person. This tests the AI's understanding and attunement.
            </p>

            <div class="card">
                <div class="card-title">What the AI Must Provide</div>
                <div class="grid-3">
                    <div class="info-box concept" style="margin: 0;">
                        <div class="info-box-title">Personality Assessment</div>
                        <p style="margin-bottom: 0; font-size: 0.9em;">A written description of what they learned about the person's character, defense mechanisms, and communication style.</p>
                    </div>
                    <div class="info-box concept" style="margin: 0;">
                        <div class="info-box-title">Core Issue Assessment</div>
                        <p style="margin-bottom: 0; font-size: 0.9em;">What does the AI think is the <em>real</em> underlying issue? This is compared against the hidden ground truth.</p>
                    </div>
                    <div class="info-box concept" style="margin: 0;">
                        <div class="info-box-title">State Assessment</div>
                        <p style="margin-bottom: 0; font-size: 0.9em;">The AI's estimate of where each emotional dimension ended up (0-10 scale for each).</p>
                    </div>
                </div>
            </div>

            <h3>How Debrief is Judged</h3>

            <p>A separate judge model evaluates the debrief across four dimensions:</p>

            <table class="styled-table">
                <thead>
                    <tr>
                        <th>Dimension</th>
                        <th>What It Measures</th>
                        <th>Scale</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Personality Insight</strong></td>
                        <td>How accurately did the AI understand the person's character and traits?</td>
                        <td>0-10</td>
                    </tr>
                    <tr>
                        <td><strong>Core Issue Insight</strong></td>
                        <td>Did the AI correctly identify the hidden underlying problem?</td>
                        <td>0-10</td>
                    </tr>
                    <tr>
                        <td><strong>Emotional Attunement</strong></td>
                        <td>How close was the AI's state estimate to the actual final state?</td>
                        <td>0-10</td>
                    </tr>
                    <tr>
                        <td><strong>Overall Understanding</strong></td>
                        <td>Holistic assessment of comprehension quality</td>
                        <td>0-10</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <!-- Section 7: Judging -->
        <section id="judging">
            <h2><span class="section-number">7</span>Performance Judging</h2>

            <p>
                Beyond the debrief, the entire conversation transcript is evaluated by judge models across <strong>25 EQ dimensions</strong>. This provides a detailed assessment of the AI's emotional intelligence capabilities.
            </p>

            <div class="info-box concept">
                <div class="info-box-title">Helpful vs. Unhelpful Dimensions</div>
                <p style="margin-bottom: 0;">
                    As with persona state, dimensions are labeled based on whether higher scores indicate better performance for the evaluated model's task: supporting the persona, building trust, learning about them, and helping them make progress.
                </p>
            </div>

            <h3>Helpful Dimensions <span class="badge badge-helpful">11 dimensions</span></h3>
            <p>Higher scores indicate better performance:</p>

            <div class="grid-4">
                <div class="dimension-card helpful">
                    <div class="dimension-name">Rapport</div>
                </div>
                <div class="dimension-card helpful">
                    <div class="dimension-name">Authenticity</div>
                </div>
                <div class="dimension-card helpful">
                    <div class="dimension-name">Trust Building</div>
                </div>
                <div class="dimension-card helpful">
                    <div class="dimension-name">Character Insight</div>
                </div>
                <div class="dimension-card helpful">
                    <div class="dimension-name">Issue Insight</div>
                </div>
                <div class="dimension-card helpful">
                    <div class="dimension-name">Emotional Support</div>
                </div>
                <div class="dimension-card helpful">
                    <div class="dimension-name">Adaptiveness</div>
                </div>
                <div class="dimension-card helpful">
                    <div class="dimension-name">Facilitation</div>
                </div>
                <div class="dimension-card helpful">
                    <div class="dimension-name">Theory of Mind</div>
                </div>
                <div class="dimension-card helpful">
                    <div class="dimension-name">Analytical Intelligence</div>
                </div>
                <div class="dimension-card helpful">
                    <div class="dimension-name">Social Agility</div>
                </div>
            </div>

            <h3>Unhelpful Dimensions <span class="badge badge-unhelpful">7 dimensions</span></h3>
            <p>Lower scores indicate better performance (these are inverted in final scoring):</p>

            <div class="grid-4">
                <div class="dimension-card unhelpful">
                    <div class="dimension-name">Manipulative</div>
                </div>
                <div class="dimension-card unhelpful">
                    <div class="dimension-name">Inauthentic</div>
                </div>
                <div class="dimension-card unhelpful">
                    <div class="dimension-name">Premature Advice</div>
                </div>
                <div class="dimension-card unhelpful">
                    <div class="dimension-name">Generic Responses</div>
                </div>
                <div class="dimension-card unhelpful">
                    <div class="dimension-name">Missed Subtext</div>
                </div>
                <div class="dimension-card unhelpful">
                    <div class="dimension-name">Missed Opportunities</div>
                </div>
                <div class="dimension-card unhelpful">
                    <div class="dimension-name">Made Things Worse</div>
                </div>
            </div>

            <h3>Neutral Dimensions <span class="badge badge-neutral">6 dimensions</span></h3>
            <p>These are tracked but not scored&mdash;context determines whether they're appropriate:</p>

            <div class="grid-4">
                <div class="dimension-card neutral">
                    <div class="dimension-name">Warmth</div>
                </div>
                <div class="dimension-card neutral">
                    <div class="dimension-name">Passive</div>
                </div>
                <div class="dimension-card neutral">
                    <div class="dimension-name">Assertive</div>
                </div>
                <div class="dimension-card neutral">
                    <div class="dimension-name">Challenging</div>
                </div>
                <div class="dimension-card neutral">
                    <div class="dimension-name">Validating</div>
                </div>
                <div class="dimension-card neutral">
                    <div class="dimension-name">Pragmatic</div>
                </div>
            </div>

            <div class="info-box example">
                <div class="info-box-title">Ensemble Judging</div>
                <p style="margin-bottom: 0;">
                    Multiple judge models evaluate each conversation, and their scores are averaged. This reduces individual judge bias and produces more reliable assessments.
                </p>
            </div>
        </section>

        <!-- Section 8: Scoring -->
        <section id="scoring">
            <h2><span class="section-number">8</span>Final Scoring</h2>

            <p>
                The final EQ-Bench score combines three components, each measuring a different aspect of emotional intelligence:
            </p>

            <div class="score-breakdown">
                <svg class="score-pie" viewBox="0 0 200 200">
                    <!-- Background circle -->
                    <circle cx="100" cy="100" r="80" fill="none" stroke="#e0dcd1" stroke-width="30" />

                    <!-- User State: 50% (180 degrees) -->
                    <circle cx="100" cy="100" r="80" fill="none" stroke="#c9a227" stroke-width="30"
                            stroke-dasharray="251.2 502.4" stroke-dashoffset="0"
                            transform="rotate(-90 100 100)" />

                    <!-- EQ Rubric: 25% (90 degrees) -->
                    <circle cx="100" cy="100" r="80" fill="none" stroke="#5a8c8c" stroke-width="30"
                            stroke-dasharray="125.6 502.4" stroke-dashoffset="-251.2"
                            transform="rotate(-90 100 100)" />

                    <!-- Debrief: 25% (90 degrees) -->
                    <circle cx="100" cy="100" r="80" fill="none" stroke="#7c5295" stroke-width="30"
                            stroke-dasharray="125.6 502.4" stroke-dashoffset="-376.8"
                            transform="rotate(-90 100 100)" />

                    <!-- Center text -->
                    <text x="100" y="95" text-anchor="middle" fill="#5c4033" font-family="Merriweather, serif" font-size="14" font-weight="700">Final</text>
                    <text x="100" y="115" text-anchor="middle" fill="#5c4033" font-family="Merriweather, serif" font-size="14" font-weight="700">Score</text>
                </svg>

                <div class="score-legend">
                    <div class="legend-item">
                        <div class="legend-color" style="background: #c9a227;"></div>
                        <div class="legend-text"><span class="legend-percent">50%</span> User State Change</div>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #5a8c8c;"></div>
                        <div class="legend-text"><span class="legend-percent">25%</span> EQ Rubric Score</div>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #7c5295;"></div>
                        <div class="legend-text"><span class="legend-percent">25%</span> Debrief Score</div>
                    </div>
                </div>
            </div>

            <div class="formula-box">
                <span class="component">Final Score</span>
                <span class="operator">=</span>
                <span class="weight">0.50</span> <span class="operator"></span> <span class="component">User State</span>
                <span class="operator">+</span>
                <span class="weight">0.25</span> <span class="operator"></span> <span class="component">EQ Rubric</span>
                <span class="operator">+</span>
                <span class="weight">0.25</span> <span class="operator"></span> <span class="component">Debrief</span>
            </div>

            <div class="info-box important">
                <div class="info-box-title">Why This Weighting?</div>
                <p style="margin-bottom: 0;">
                    <strong>User State (50%)</strong> is weighted highest because it directly measures the <em>impact</em> of the conversation&mdash;did the person actually feel better and make progress? <strong>EQ Rubric (25%)</strong> assesses conversation quality and technique. <strong>Debrief (25%)</strong> measures understanding and attunement. Together, they capture both <em>effectiveness</em> and <em>skill</em>.
                </p>
            </div>
        </section>

        <!-- Summary / TL;DR -->
        <section id="summary">
            <h2>Summary: The Complete Flow</h2>

            <div class="diagram-container">
                <svg viewBox="0 0 900 500" xmlns="http://www.w3.org/2000/svg">
                    <!-- Background sections -->
                    <rect x="20" y="20" width="860" height="100" rx="10" fill="#f0ebe3" opacity="0.5" />
                    <rect x="20" y="130" width="860" height="140" rx="10" fill="#e8d8f0" opacity="0.3" />
                    <rect x="20" y="280" width="860" height="100" rx="10" fill="#d8e8e8" opacity="0.3" />
                    <rect x="20" y="390" width="860" height="90" rx="10" fill="#d8f0d8" opacity="0.3" />

                    <!-- Section labels -->
                    <text x="40" y="45" fill="#5c4033" font-family="Merriweather, serif" font-size="12" font-weight="700">1. GENERATION (offline)</text>
                    <text x="40" y="155" fill="#6c4285" font-family="Merriweather, serif" font-size="12" font-weight="700">2. CONVERSATION</text>
                    <text x="40" y="305" fill="#4a7c7c" font-family="Merriweather, serif" font-size="12" font-weight="700">3. EVALUATION</text>
                    <text x="40" y="415" fill="#3a8c5d" font-family="Merriweather, serif" font-size="12" font-weight="700">4. SCORING</text>

                    <!-- Generation row -->
                    <rect x="50" y="60" width="120" height="50" rx="6" fill="#6a8caf" />
                    <text x="110" y="90" text-anchor="middle" fill="white" font-family="Lora, serif" font-size="11">Registry</text>

                    <text x="190" y="90" fill="#7a6a60" font-size="20"></text>

                    <rect x="210" y="60" width="120" height="50" rx="6" fill="#7c5295" />
                    <text x="270" y="90" text-anchor="middle" fill="white" font-family="Lora, serif" font-size="11">Generator</text>

                    <text x="350" y="90" fill="#7a6a60" font-size="20"></text>

                    <rect x="370" y="60" width="120" height="50" rx="6" fill="#c9a227" />
                    <text x="430" y="90" text-anchor="middle" fill="white" font-family="Lora, serif" font-size="11">Scenarios</text>

                    <!-- Conversation row -->
                    <rect x="50" y="175" width="150" height="80" rx="6" fill="#4a9c6d" />
                    <text x="125" y="205" text-anchor="middle" fill="white" font-family="Merriweather, serif" font-size="11" font-weight="700">Evaluated AI</text>
                    <text x="125" y="225" text-anchor="middle" fill="#b0e0c0" font-family="Lora, serif" font-size="10">(Being tested)</text>

                    <path d="M 200 215 C 280 215, 280 215, 360 215" fill="none" stroke="#7a6a60" stroke-width="2" marker-end="url(#arrowhead)" />
                    <path d="M 360 225 C 280 225, 280 225, 200 225" fill="none" stroke="#7a6a60" stroke-width="2" marker-end="url(#arrowhead)" />
                    <text x="280" y="205" text-anchor="middle" fill="#7a6a60" font-family="Lora, serif" font-size="9">8 turns each</text>

                    <rect x="360" y="175" width="150" height="80" rx="6" fill="#7c5295" />
                    <text x="435" y="205" text-anchor="middle" fill="white" font-family="Merriweather, serif" font-size="11" font-weight="700">Persona Sim</text>
                    <text x="435" y="225" text-anchor="middle" fill="#d0c0e0" font-family="Lora, serif" font-size="10">(Plays the person)</text>

                    <text x="530" y="220" fill="#7a6a60" font-size="20"></text>

                    <rect x="550" y="175" width="150" height="80" rx="6" fill="#c9a227" />
                    <text x="625" y="200" text-anchor="middle" fill="white" font-family="Merriweather, serif" font-size="11" font-weight="700">State Updates</text>
                    <text x="625" y="220" text-anchor="middle" fill="#f0e0b0" font-family="Lora, serif" font-size="10">20 dimensions</text>
                    <text x="625" y="240" text-anchor="middle" fill="#f0e0b0" font-family="Lora, serif" font-size="10">tracked per turn</text>

                    <!-- Evaluation row -->
                    <rect x="50" y="320" width="180" height="50" rx="6" fill="#5a8c8c" />
                    <text x="140" y="350" text-anchor="middle" fill="white" font-family="Lora, serif" font-size="11">EQ Rubric Judging (25 dim)</text>

                    <rect x="250" y="320" width="180" height="50" rx="6" fill="#7c5295" />
                    <text x="340" y="350" text-anchor="middle" fill="white" font-family="Lora, serif" font-size="11">Debrief Assessment</text>

                    <rect x="450" y="320" width="180" height="50" rx="6" fill="#c9a227" />
                    <text x="540" y="350" text-anchor="middle" fill="white" font-family="Lora, serif" font-size="11">State Delta Calculation</text>

                    <!-- Scoring row -->
                    <rect x="150" y="420" width="100" height="40" rx="6" fill="#5a8c8c" />
                    <text x="200" y="445" text-anchor="middle" fill="white" font-family="Lora, serif" font-size="10">25%</text>

                    <text x="265" y="445" fill="#7a6a60" font-size="16">+</text>

                    <rect x="280" y="420" width="100" height="40" rx="6" fill="#7c5295" />
                    <text x="330" y="445" text-anchor="middle" fill="white" font-family="Lora, serif" font-size="10">25%</text>

                    <text x="395" y="445" fill="#7a6a60" font-size="16">+</text>

                    <rect x="410" y="420" width="100" height="40" rx="6" fill="#c9a227" />
                    <text x="460" y="445" text-anchor="middle" fill="white" font-family="Lora, serif" font-size="10">50%</text>

                    <text x="530" y="445" fill="#7a6a60" font-size="16">=</text>

                    <rect x="550" y="410" width="150" height="60" rx="8" fill="#4a9c6d" />
                    <text x="625" y="438" text-anchor="middle" fill="white" font-family="Merriweather, serif" font-size="14" font-weight="700">Final Score</text>
                    <text x="625" y="458" text-anchor="middle" fill="#b0e0c0" font-family="Lora, serif" font-size="11">(0-10)</text>

                    <!-- Connecting arrows -->
                    <line x1="140" y1="370" x2="175" y2="420" stroke="#5a8c8c" stroke-width="2" />
                    <line x1="340" y1="370" x2="330" y2="420" stroke="#7c5295" stroke-width="2" />
                    <line x1="540" y1="370" x2="460" y2="420" stroke="#c9a227" stroke-width="2" />
                </svg>
                <div class="diagram-caption">The complete EQ-Bench 4 evaluation pipeline</div>
            </div>
        </section>

        <!-- Footer -->
        <div class="footer">
            <h3 style="margin-top: 0;">EQ-Bench 4</h3>
            <p>Measuring emotional intelligence in AI through realistic, dynamic conversations.</p>
            <div class="footer-links">
                <a href="https://eqbench.com" target="_blank">EQ-Bench Website</a>
                <a href="personas_viewer.html">Meet the Personas</a>
            </div>
        </div>
    </div>

    <script>
        // Dark mode
        const STORAGE_KEY = 'eqbenchDarkMode';

        function setDarkMode(isDark) {
            document.body.classList.toggle('dark-mode', isDark);
            const toggle = document.getElementById('darkModeToggle');
            const label = document.getElementById('toggleLabel');
            if (label) label.textContent = isDark ? 'Dark Mode' : 'Light Mode';
            if (toggle && toggle.checked !== isDark) toggle.checked = isDark;
            localStorage.setItem(STORAGE_KEY, isDark);
        }

        // Initialize on load
        window.addEventListener('DOMContentLoaded', () => {
            // Dark mode
            const toggle = document.getElementById('darkModeToggle');
            const savedMode = localStorage.getItem(STORAGE_KEY);
            const initialDark = (savedMode === 'true') ||
                (savedMode === null && window.matchMedia('(prefers-color-scheme: dark)').matches);
            setDarkMode(initialDark);
            if (toggle) {
                toggle.addEventListener('change', (e) => setDarkMode(e.target.checked));
            }

            // Smooth scroll for nav links
            document.querySelectorAll('.nav-links a').forEach(link => {
                link.addEventListener('click', (e) => {
                    const href = link.getAttribute('href');
                    if (href.startsWith('#')) {
                        e.preventDefault();
                        const target = document.querySelector(href);
                        if (target) {
                            target.scrollIntoView({ behavior: 'smooth' });
                        }
                    }
                });
            });
        });
    </script>
</body>
</html>
